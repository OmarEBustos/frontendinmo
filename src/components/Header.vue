<template>
  <header class="header header-absolute">
      <!-- Top Bar
      <div class="top-bar">
        <div class="container-fluid">
          <div class="row d-flex align-items-center">
            <div class="col-sm-7 d-none d-sm-block">
              <ul class="list-inline topbar-text mb-0">
                <li class="list-inline-item pe-3 me-0">
                  <img src="/assets/icons/telephone-bl.png" style="width: 16px;">
                  020-800-456-747
                </li>
                <li class="list-inline-item px-3 border-start d-none d-lg-inline-block">Envios gratis desde $300</li>
              </ul>
            </div>
            <div class="col-sm-5 d-flex justify-content-end">
>
              

              <div class="dropdown border-end px-3"><a class="dropdown-toggle topbar-link" id="langsDropdown" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-haspopup="true" aria-expanded="false"><img class="topbar-flag" src="https://d19m59y37dris4.cloudfront.net/sell/2-0/img/flag/gb.svg" alt="english">English</a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-animated" aria-labelledby="langsDropdown"><a class="dropdown-item text-sm" href="#"><img class="topbar-flag" src="https://d19m59y37dris4.cloudfront.net/sell/2-0/img/flag/de.svg" alt="german">German</a><a class="dropdown-item text-sm" href="#"> <img class="topbar-flag" src="https://d19m59y37dris4.cloudfront.net/sell/2-0/img/flag/fr.svg" alt="french">French</a></div>
              </div>

              <div class="dropdown ps-3 ms-0"><a class="dropdown-toggle topbar-link" id="currencyDropdown" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-haspopup="true" aria-expanded="false">USD</a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-animated" aria-labelledby="currencyDropdown">
                  <a class="dropdown-item text-sm" href="#"> 
                    EUR
                  </a>
                  <a class="dropdown-item text-sm" href="#">
                    GBP
                    </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
       <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>


        <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav mx-auto">
              <li class="nav-item">
                <router-link class="nav-link" to="/">Inicio</router-link>
              </li>
              <li class="nav-item">
                <router-link class="nav-link" :to="{name: 'shop'}" >Tienda</router-link>
              </li>
              
              <li class="nav-item dropdown position-static">
                <router-link class="nav-link" :to="{name: 'about'}" >Nosotros</router-link>
              </li>
              <li class="nav-item dropdown position-static">
                <router-link class="nav-link" :to="{name: 'contact'}" >Contact</router-link>
              </li>
              
              
            </ul>
            <div class="d-flex align-items-center justify-content-between justify-content-lg-end mt-1 mb-2 my-lg-0">
                
                        </div>
                    </div>
                

        <div class="menu-logo">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-5" href="index.html">PersonaM4</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.html" aria-expanded="false">

                        Home</a>
                </li>
                <li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="https://mobirise.co" aria-expanded="false" data-toggle="dropdown-submenu">

                        Live Demo</a><div class="dropdown-menu"><a class="text-white dropdown-item display-4" href="portfolio.html" aria-expanded="false">Portfolio Demo</a><a class="text-white dropdown-item display-4" href="creativestudio.html" aria-expanded="false">Creative Studio Demo</a><a class="text-white dropdown-item display-4" href="craftshop.html" aria-expanded="false">Craft Shop Demo</a></div></li>
                <li class="nav-item dropdown"><a class="nav-link link text-white dropdown-toggle display-4" href="https://mobirise.co" data-toggle="dropdown-submenu" aria-expanded="true">

                        Live Demo Blocks</a><div class="dropdown-menu"><a class="text-white dropdown-item display-4" href="headers.html">Headers / Features / Content</a><a class="text-white dropdown-item display-4" href="images.html" aria-expanded="false">Countries / Images / Progress</a><a class="text-white dropdown-item display-4" href="info.html" aria-expanded="false">Info / Countdowns / Pricing</a><a class="text-white dropdown-item display-4" href="video.html" aria-expanded="false">Video / Accordions / Tabs</a><a class="text-white dropdown-item display-4" href="clients.html" aria-expanded="false">Clients / Form / Social / Shop</a><a class="text-white dropdown-item display-4" href="maps.html" aria-expanded="false">Testimonials / Maps / Footers</a></div></li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link link text-white display-4" href="https://mobirise.co">
                    </a>
                </li></ul>
            <div class="navbar-buttons mbr-section-btn"><a class="btn btn-sm btn-white-outline display-4" href="https://my.mobirise.com/buy.php?p=73">

                    BUY NOW</a></div>
        </div>
    </nav> navbar-airy navbar-expand-lg -->

    
 <!-- Navbar Collapse class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
         -->
      <nav class="navbar navbar-expand-lg navbar-sticky navbar-airy " style="background: #FFFFFF !important; font-family:Inter !important;">
        <div class="container-fluid">  <a class="navbar-brand" style="color:rgb(58, 57, 57) !important; height: 70 !important" >
          <img class="" src="/assets/real estate logo.png" alt="" style="width: 22% !important" >
        </a>
          
        <button class="navbar-toggler navbar-toggler-left" 
          type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" 
          aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          
          <!-- <i class="fas fa-bars"></i><!--> 
            <img class="hamburg" src="/assets/menu-hamburguesa.png" alt=""   >
  
        </button>
       
         
          <div class="collapse navbar-collapse" id="navbarCollapse" >
            <ul class="navbar-nav mx-auto">
              <li class="nav-item">
                <router-link class="nav-link" to="/">Home</router-link>
              </li>
              <li class="nav-item">
                <router-link class="nav-link" :to="{name: 'shop'}" >Properties</router-link>
              </li>
              
              <li class="nav-item dropdown position-static"> 
                <router-link class="nav-link" :to="{name: 'about'}" >About&nbsp;&nbsp;Us</router-link>
              </li>
              <li class="nav-item dropdown position-static">
                <router-link class="nav-link" :to="{name: 'contact'}" >Contact</router-link>
              </li>
              
              
            </ul>
            
            <!--<div class="d-flex align-items-center justify-content-between justify-content-lg-end mt-1 mb-2 my-lg-0"><!-->
            
                        
                    </div>
                </div>
               
      </nav> <hr style="margin-top: -4px;">
      <!-- /Navbar -->
      <!-- Fullscreen search area
      <div class="search-area-wrapper">
        <div class="search-area d-flex align-items-center justify-content-center">
          <div class="close-btn">
            <svg class="svg-icon svg-icon-light w-3rem h-3rem">
              <use xlink:href="#close-1"> </use>
            </svg>
          </div>
          <form class="search-area-form" action="#">
            <div class="mb-4 position-relative">
              <input class="search-area-input" type="search" name="search" id="search" placeholder="What are you looking for?">
              <button class="search-area-button" type="submit">
                <svg class="svg-icon">
                  <use xlink:href="#search-1"> </use>
                </svg>
              </button>
            </div>
          </form>
        </div>
      </div> width: 20%;
  margin-left: 200%;
  margin-top: -20px;
.navbar-light .navbar-nav .nav-link, .navbar-hover-light:hover .navbar-nav .nav-link, .navbar-fixed-light.fixed-top .navbar-nav .nav-link {
    color: rgb(74, 72, 72) !important;
}
      < /Fullscreen search area-->
  </header>
</template>

<style>

.navbar-light .navbar-nav .nav-link, .navbar-hover-light:hover .navbar-nav .nav-link, .navbar-fixed-light.fixed-top .navbar-nav .nav-link {
    color: rgb(74, 72, 72) !important;
}
@media (max-width: 500px) {

  
  .hamburg {
    margin-top: -50px !important;
    width: 20px !important;
    margin-left: 320px !important;
  }
 
  
    
}
@media (max-width: 800px) {

  
.hamburg {
  margin-top: -40px ;
  width: 40px ;
  margin-left: 700px;
}
  
}

</style>

<script>

import axios from 'axios';
import currency_formatter from 'currency-formatter';

export default {
  name: 'Header',
  data() {
    return {
      user: JSON.parse(this.$store.state.user),
      carrito: [],
      total: 0,
      carrito_length : 0,
    }
  },
 
  methods: {
    convertCurrency(number){
        return currency_formatter.format(number, { code: 'USD' });
    },
    logout(){
        this.$store.dispatch('logout');
        if(this.$route.path !== '/') this.$router.push({name: 'home'});
        /* window.location.reload(); */
        this.carrito = [];
        this.carrito_length = 0;
    },
    init_carrito(){
      if(this.$store.state.token != null){
        axios.get(this.$url+'/obtener_carrito_cliente',{
            headers: {
                'Content-Type': 'application/json',
                'Authorization': this.$store.state.token
            }
        }).then((result)=>{
          this.carrito_length = result.data.carrito_general.length;
          this.total = 0;
          for(var item of result.data.carrito_general){
            let subtotal = item.producto.precio * item.cantidad;
            this.total = this.total+ subtotal;
          }
          this.carrito = result.data.carrito;
        });
      }
    },
  click_event(){
      this.$socket.emit('emit_method', 'Hola socket');
    }
  },

  created() {
    this.sockets.subscribe('listen_cart', (data) => {
        this.init_carrito();
        this.user = JSON.parse(this.$store.state.user);
    });
  },  
  
  beforeMount() {
   this.init_carrito();
    
  },

  

}
</script>
